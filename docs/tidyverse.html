<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 Básico do Tidyverse | Cartografia Temática em R para estudantes de Geografia</title>
  <meta name="description" content=" 4 Básico do Tidyverse | Cartografia Temática em R para estudantes de Geografia" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 Básico do Tidyverse | Cartografia Temática em R para estudantes de Geografia" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 Básico do Tidyverse | Cartografia Temática em R para estudantes de Geografia" />
  
  
  

<meta name="author" content="Ligia Vizeu Barrozo" />


<meta name="date" content="2023-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataframes.html"/>
<link rel="next" href="tipos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Carto Tem Geo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Apresentação</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referência-citada"><i class="fa fa-check"></i>Referência citada</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-o-livro.html"><a href="sobre-o-livro.html"><i class="fa fa-check"></i>Sobre o livro</a></li>
<li class="chapter" data-level="" data-path="agradecimentos.html"><a href="agradecimentos.html"><i class="fa fa-check"></i>Agradecimentos</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-programa-r"><i class="fa fa-check"></i><b>1.1</b> O programa R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#instalação-do-r-e-rstudio"><i class="fa fa-check"></i><b>1.2</b> Instalação do R e RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#instalação-do-r-para-windows"><i class="fa fa-check"></i><b>1.2.1</b> Instalação do R para Windows</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#instalação-do-r-para-mac"><i class="fa fa-check"></i><b>1.2.2</b> Instalação do R para Mac</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#instalação-do-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Instalação do RStudio</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#instalação-do-rtools"><i class="fa fa-check"></i><b>1.2.4</b> Instalação do RTools</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html"><i class="fa fa-check"></i><b>2</b> Básico do básico do R e RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#os-paineis"><i class="fa fa-check"></i><b>2.1</b> Os paineis</a></li>
<li class="chapter" data-level="2.2" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.2</b> Tipos de objetos</a></li>
<li class="chapter" data-level="2.3" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#estrutura-dos-dados"><i class="fa fa-check"></i><b>2.3</b> Estrutura dos dados</a></li>
<li class="chapter" data-level="2.4" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#vetores"><i class="fa fa-check"></i><b>2.4</b> Vetores</a></li>
<li class="chapter" data-level="2.5" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#nomeando-os-vetores"><i class="fa fa-check"></i><b>2.5</b> Nomeando os vetores</a></li>
<li class="chapter" data-level="2.6" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#seleção-em-vetores"><i class="fa fa-check"></i><b>2.6</b> Seleção em vetores</a></li>
<li class="chapter" data-level="2.7" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#totais-e-médias-em-vetores"><i class="fa fa-check"></i><b>2.7</b> Totais e médias em vetores</a></li>
<li class="chapter" data-level="2.8" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#matrizes"><i class="fa fa-check"></i><b>2.8</b> Matrizes</a></li>
<li class="chapter" data-level="2.9" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#cálculos-em-matrizes"><i class="fa fa-check"></i><b>2.9</b> Cálculos em Matrizes</a></li>
<li class="chapter" data-level="2.10" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#seleção-em-matrizes"><i class="fa fa-check"></i><b>2.10</b> Seleção em Matrizes</a></li>
<li class="chapter" data-level="2.11" data-path="básico-do-básico-do-r-e-rstudio.html"><a href="básico-do-básico-do-r-e-rstudio.html#fatores"><i class="fa fa-check"></i><b>2.11</b> Fatores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataframes.html"><a href="dataframes.html"><i class="fa fa-check"></i><b>3</b> Dataframes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataframes.html"><a href="dataframes.html#criação-de-dataframe"><i class="fa fa-check"></i><b>3.1</b> Criação de dataframe</a></li>
<li class="chapter" data-level="3.2" data-path="dataframes.html"><a href="dataframes.html#importação-de-um-dataframe"><i class="fa fa-check"></i><b>3.2</b> Importação de um dataframe</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> Básico do Tidyverse</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#o-operador-pipe-no-tidyverse"><i class="fa fa-check"></i><b>4.1</b> O operador Pipe no tidyverse</a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html#selecionando-colunas"><i class="fa fa-check"></i><b>4.2</b> Selecionando colunas</a></li>
<li class="chapter" data-level="4.3" data-path="tidyverse.html"><a href="tidyverse.html#combinando-dataframes"><i class="fa fa-check"></i><b>4.3</b> Combinando dataframes</a></li>
<li class="chapter" data-level="4.4" data-path="tidyverse.html"><a href="tidyverse.html#filtrando-observações"><i class="fa fa-check"></i><b>4.4</b> Filtrando observações</a></li>
<li class="chapter" data-level="4.5" data-path="tidyverse.html"><a href="tidyverse.html#organizando-uma-tabela-com-a-função-arrange"><i class="fa fa-check"></i><b>4.5</b> Organizando uma tabela com a função <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6" data-path="tidyverse.html"><a href="tidyverse.html#o-verbo-mutate"><i class="fa fa-check"></i><b>4.6</b> O verbo “mutate”</a></li>
<li class="chapter" data-level="4.7" data-path="tidyverse.html"><a href="tidyverse.html#agrupando-dados-com-a-função-group_by"><i class="fa fa-check"></i><b>4.7</b> Agrupando dados com a função <code>group_by</code></a></li>
<li class="chapter" data-level="4.8" data-path="tidyverse.html"><a href="tidyverse.html#rumo-aos-mapas"><i class="fa fa-check"></i><b>4.8</b> Rumo aos mapas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tipos.html"><a href="tipos.html"><i class="fa fa-check"></i><b>5</b> Tipos de dados, conceitos e representação cartográfica</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tipos.html"><a href="tipos.html#definição-do-tipo-de-representação-cartográfica"><i class="fa fa-check"></i><b>5.1</b> Definição do tipo de representação cartográfica</a></li>
<li class="chapter" data-level="5.2" data-path="tipos.html"><a href="tipos.html#variáveis-visuais"><i class="fa fa-check"></i><b>5.2</b> Variáveis visuais</a></li>
<li class="chapter" data-level="5.3" data-path="tipos.html"><a href="tipos.html#o-conceito-diversidade"><i class="fa fa-check"></i><b>5.3</b> O conceito <em>diversidade</em></a></li>
<li class="chapter" data-level="5.4" data-path="tipos.html"><a href="tipos.html#o-conceito-ordem"><i class="fa fa-check"></i><b>5.4</b> O conceito <em>ordem</em></a></li>
<li class="chapter" data-level="5.5" data-path="tipos.html"><a href="tipos.html#o-conceito-de-proporcionalidade"><i class="fa fa-check"></i><b>5.5</b> O conceito de <em>proporcionalidade</em></a></li>
<li class="chapter" data-level="5.6" data-path="tipos.html"><a href="tipos.html#referências-sugeridas"><i class="fa fa-check"></i><b>5.6</b> Referências sugeridas</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="quali1.html"><a href="quali1.html"><i class="fa fa-check"></i><b>6</b> Dados qualitativos: mapa corocromático nominal</a>
<ul>
<li class="chapter" data-level="6.1" data-path="quali1.html"><a href="quali1.html#instalando-e-carregando-pacotes-do-r"><i class="fa fa-check"></i><b>6.1</b> Instalando e carregando pacotes do R</a></li>
<li class="chapter" data-level="6.2" data-path="quali1.html"><a href="quali1.html#o-pacote-geobr"><i class="fa fa-check"></i><b>6.2</b> O pacote geobr</a></li>
<li class="chapter" data-level="6.3" data-path="quali1.html"><a href="quali1.html#projeção-cartográfica"><i class="fa fa-check"></i><b>6.3</b> Projeção cartográfica</a></li>
<li class="chapter" data-level="6.4" data-path="quali1.html"><a href="quali1.html#iniciando-com-o-ggplot2"><i class="fa fa-check"></i><b>6.4</b> Iniciando com o ggplot2</a></li>
<li class="chapter" data-level="6.5" data-path="quali1.html"><a href="quali1.html#biomas-do-brasil"><i class="fa fa-check"></i><b>6.5</b> Biomas do Brasil</a></li>
<li class="chapter" data-level="" data-path="quali1.html"><a href="quali1.html#referências-citadas"><i class="fa fa-check"></i>Referências citadas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="quali2.html"><a href="quali2.html"><i class="fa fa-check"></i><b>7</b> Dados qualitativos: mapa corocromático ordinal</a>
<ul>
<li class="chapter" data-level="7.1" data-path="quali2.html"><a href="quali2.html#banco-de-dados"><i class="fa fa-check"></i><b>7.1</b> Banco de dados</a></li>
<li class="chapter" data-level="7.2" data-path="quali2.html"><a href="quali2.html#potencial-de-agressividade-climática-na-amazônia-legal-do-brasil"><i class="fa fa-check"></i><b>7.2</b> Potencial de agressividade climática na Amazônia Legal do Brasil</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quanti1.html"><a href="quanti1.html"><i class="fa fa-check"></i><b>8</b> Dados quantitativos absolutos: mapa das figuras geométricas proporcionais</a>
<ul>
<li class="chapter" data-level="8.1" data-path="quanti1.html"><a href="quanti1.html#bases-de-dados"><i class="fa fa-check"></i><b>8.1</b> Bases de dados</a></li>
<li class="chapter" data-level="8.2" data-path="quanti1.html"><a href="quanti1.html#centroides-dos-municípios"><i class="fa fa-check"></i><b>8.2</b> Centroides dos municípios</a></li>
<li class="chapter" data-level="8.3" data-path="quanti1.html"><a href="quanti1.html#mapa-da-população-do-estado-de-são-paulo"><i class="fa fa-check"></i><b>8.3</b> Mapa da população do estado de São Paulo</a></li>
<li class="chapter" data-level="8.4" data-path="quanti1.html"><a href="quanti1.html#referências-sugeridas-1"><i class="fa fa-check"></i><b>8.4</b> Referências sugeridas</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quanti2.html"><a href="quanti2.html"><i class="fa fa-check"></i><b>9</b> Dados quantitativos absolutos: mapa dos pontos de contagem (ou densidade de pontos)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quanti2.html"><a href="quanti2.html#bases-de-dados-1"><i class="fa fa-check"></i><b>9.1</b> Bases de dados</a></li>
<li class="chapter" data-level="9.2" data-path="quanti2.html"><a href="quanti2.html#definição-dos-pontos-aleatórios"><i class="fa fa-check"></i><b>9.2</b> Definição dos pontos aleatórios</a></li>
<li class="chapter" data-level="9.3" data-path="quanti2.html"><a href="quanti2.html#mapa-de-raça-ou-cor-dos-residentes-do-município-de-são-paulo"><i class="fa fa-check"></i><b>9.3</b> Mapa de raça ou cor dos residentes do município de São Paulo</a></li>
<li class="chapter" data-level="9.4" data-path="quanti2.html"><a href="quanti2.html#referências-sugeridas-2"><i class="fa fa-check"></i><b>9.4</b> Referências sugeridas</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="quanti3.html"><a href="quanti3.html"><i class="fa fa-check"></i><b>10</b> Dados quantitativos relativos: mapa coroplético</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="quanti3.html"><a href="quanti3.html#o-número-de-classes"><i class="fa fa-check"></i><b>10.0.1</b> O número de classes</a></li>
<li class="chapter" data-level="10.0.2" data-path="quanti3.html"><a href="quanti3.html#os-intervalos-de-classes"><i class="fa fa-check"></i><b>10.0.2</b> Os intervalos de classes</a></li>
<li class="chapter" data-level="10.0.3" data-path="quanti3.html"><a href="quanti3.html#escalacores"><i class="fa fa-check"></i><b>10.0.3</b> A escala de cores</a></li>
<li class="chapter" data-level="10.1" data-path="quanti3.html"><a href="quanti3.html#layout-do-mapa-coroplético-de-idhm-da-rmsp"><i class="fa fa-check"></i><b>10.1</b> Layout do mapa coroplético de IDHM da RMSP</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="quanti4.html"><a href="quanti4.html"><i class="fa fa-check"></i><b>11</b> Mapa coroplético interativo</a>
<ul>
<li class="chapter" data-level="11.1" data-path="quanti4.html"><a href="quanti4.html#indo-além-proposta-de-exercício"><i class="fa fa-check"></i><b>11.1</b> Indo além: Proposta de exercício</a></li>
<li class="chapter" data-level="11.2" data-path="quanti4.html"><a href="quanti4.html#referências-sugeridas-3"><i class="fa fa-check"></i><b>11.2</b> Referências sugeridas</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cartografia Temática em R para estudantes de Geografia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number"> 4</span> Básico do Tidyverse<a href="tidyverse.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Quando instalamos o <strong>R</strong> e o <strong>RStudio</strong>, apenas as funções básicas do <strong>R</strong> são instaladas. Outros pacotes são necessários para funções específicas.</p>
<p>Um pacote que permite a organização e manipulação de dados é o <strong>Tidyverse</strong>. Este pacote contém outros, tais como: <em>ggplot2</em>, <em>dplyr</em>, <em>tidyr</em>, <em>readr</em>, <em>purrr</em>, <em>tibble</em>, <em>stringr</em>, <em>forcats</em>.</p>
<p>O primeiro passo será instalar o pacote <strong>tidyverse</strong>, usando a função <strong>install.packages()</strong>. Alternativamente, é possível fazer a instalação usando a ferramenta <strong>Tools/Install Packages</strong> do menu do <strong>RStudio</strong>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="tidyverse.html#cb153-1" tabindex="-1"></a><span class="co">#para instalar o pacote</span></span>
<span id="cb153-2"><a href="tidyverse.html#cb153-2" tabindex="-1"></a><span class="fu">install.packages</span>(tidyverse)</span></code></pre></div>
<p>Depois de instalado, o pacote precisa ser carregado a partir da função <strong>library()</strong>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="tidyverse.html#cb154-1" tabindex="-1"></a><span class="co">#para carregar o pacote instalado</span></span>
<span id="cb154-2"><a href="tidyverse.html#cb154-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Observe que ao carregar o pacote <strong>tidyverse</strong>, os pacotes <em>ggplot2</em>, <em>dplyr</em>, <em>tidyr</em>, <em>readr</em>, <em>purrr</em>, <em>tibble</em>, <em>stringr</em>, <em>forcats</em> são carregados também.</p>
<div id="o-operador-pipe-no-tidyverse" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> O operador Pipe no tidyverse<a href="tidyverse.html#o-operador-pipe-no-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O operador <strong>%&gt;%</strong> é usado para expressar uma sequência de operações múltiplas, por exemplo, a saída de uma função ou expressão é passada a uma outra função como um argumento. No código, pode ser traduzido como <strong>então</strong>.</p>
<p><strong>Pontos importantes no uso do Pipe no R</strong></p>
<ul>
<li><p>quando usar o pacote <strong>tidyverse</strong> o operador %&gt;% fica automaticamente disponível para uso.</p></li>
<li><p>ele considera a saída de uma função e a usa em outra função como um argumento;</p></li>
<li><p>funciona com uma função que leva uma entrada;</p></li>
<li><p>se uma função precisar de duas entradas, então não poderá ser usado.</p></li>
</ul>
<p>Quando você tem um código complexo para escrever na programação <strong>R</strong>, às vezes você aninha as operações que resultam em um código <strong>R</strong> ilegível e é difícil para outras pessoas entenderem. Usando o operador <strong>%&gt;%</strong> é possível encadear uma sequência para evitar a gravação de código complexo.</p>
<p>Além disso, usando o operador Pipe <strong>%&gt;%</strong> ajuda a economizar memória. Por causa disso, tem sido usado em muitos pacotes do <strong>R</strong>. Por exemplo, imagine que você tenha chamado 3 funções e o resultado de cada função é passado como entrada para a função subsequente. Quando você não usa o Pipe, você tem que armazenar o resultado de cada função em uma variável e usar esta variável em outra função. Desta forma você armazena 3 variáveis na memória com os dados. Ao usar o operador Pipe, você pode evitar variáveis intermediárias e encadear as funções.</p>
</div>
<div id="selecionando-colunas" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Selecionando colunas<a href="tidyverse.html#selecionando-colunas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vimos que ‘codigos’ contém diversas colunas que não serão utilizadas. Interessam-nos apenas as colunas ‘cod_ibge’, ‘municipios’ e ‘reg_administrativa’. Para criar um novo dataframe com apenas estas duas colunas, vamos usar a função <code>select</code>. Atribuiremos à seleção, o nome de ‘nomes_munic’.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="tidyverse.html#cb155-1" tabindex="-1"></a><span class="co">#para selecionar apenas as colunas &#39;cod_ibge&#39;, &#39;municipios&#39; e &#39;reg_administrativa&#39;</span></span>
<span id="cb155-2"><a href="tidyverse.html#cb155-2" tabindex="-1"></a>nomes_munic <span class="ot">&lt;-</span> codigos <span class="sc">%&gt;%</span> </span>
<span id="cb155-3"><a href="tidyverse.html#cb155-3" tabindex="-1"></a>  <span class="fu">select</span>(cod_ibge, municipios, reg_administrativa)</span>
<span id="cb155-4"><a href="tidyverse.html#cb155-4" tabindex="-1"></a><span class="co">#para visualizar</span></span>
<span id="cb155-5"><a href="tidyverse.html#cb155-5" tabindex="-1"></a><span class="fu">head</span>(nomes_munic)</span></code></pre></div>
<pre><code>##   cod_ibge          municipios          reg_administrativa
## 1  3500000 Estado de São Paulo    Estado sem especificação
## 2  3500105          Adamantina   RA de Presidente Prudente
## 3  3500204              Adolfo RA de São José do Rio Preto
## 4  3500303               Aguaí              RA de Campinas
## 5  3500402      Águas da Prata              RA de Campinas
## 6  3500501    Águas de Lindóia              RA de Campinas</code></pre>
</div>
<div id="combinando-dataframes" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Combinando dataframes<a href="tidyverse.html#combinando-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O <strong>Tidyverse</strong> oferece diversas possibilidades de unir dois dataframes. Este resumo em pdf apresenta as principais funções do <strong>Tidyverse</strong> (<a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf</a>).
Os conjuntos de dados podem ser combinados a partir das seguintes funções: <code>left_join</code>, <code>right_join</code>, <code>inner_join</code>, <code>full_join</code>, <code>semi_join</code> e <code>anti_join</code>.</p>
<p>Como podemos observar, os dois dataframes (‘evol_casam’ e ‘nomes_munic’) têm uma coluna com o mesmo nome (‘cod_ibge’), cujos códigos apresentam 7 dígitos. Desta forma, esta coluna será usada para unirmos os dois dataframes para termos os nomes dos municípios, que não aparecem em ‘evol_casam’.</p>
<p>Com os dois dataframes, podemos uni-los usando a função <code>right_join</code>. Imagine duas tabelas que serão unidas. A tabela de ‘nomes_munic’ contém 646 linhas. A tabela de ‘evol_casam’ contém 14123 linhas porque são 21 anos de dados. Queremos que a tabela ‘evol_casam’ receba os nomes dos municípios da tabela ‘nomes_munic’. Usando a função <code>right_join</code> os nomes dos municípios da tabela à esquerda (nomes_munic) farão correspondência com todas as linhas da tabela à direita (evol_casam).</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="tidyverse.html#cb157-1" tabindex="-1"></a><span class="co">#para unir os dois dataframes</span></span>
<span id="cb157-2"><a href="tidyverse.html#cb157-2" tabindex="-1"></a>casam <span class="ot">&lt;-</span> <span class="fu">right_join</span>(nomes_munic, evol_casam, <span class="at">by=</span><span class="st">&quot;cod_ibge&quot;</span>)</span>
<span id="cb157-3"><a href="tidyverse.html#cb157-3" tabindex="-1"></a><span class="co">#para visualizar as 6 primeiras linhas</span></span>
<span id="cb157-4"><a href="tidyverse.html#cb157-4" tabindex="-1"></a><span class="fu">head</span>(casam)</span></code></pre></div>
<pre><code>##   cod_ibge municipios        reg_administrativa  ano
## 1  3500105 Adamantina RA de Presidente Prudente 2000
## 2  3500105 Adamantina RA de Presidente Prudente 2001
## 3  3500105 Adamantina RA de Presidente Prudente 2002
## 4  3500105 Adamantina RA de Presidente Prudente 2003
## 5  3500105 Adamantina RA de Presidente Prudente 2004
## 6  3500105 Adamantina RA de Presidente Prudente 2005
##   entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                               139                          NA
## 2                               136                          NA
## 3                               112                          NA
## 4                               141                          NA
## 5                               119                          NA
## 6                               125                          NA
##   ignorado total
## 1       NA   139
## 2       NA   136
## 3       NA   112
## 4       NA   141
## 5       NA   119
## 6       NA   125</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="tidyverse.html#cb159-1" tabindex="-1"></a><span class="co">#para visualizar as 6 últimas linhas</span></span>
<span id="cb159-2"><a href="tidyverse.html#cb159-2" tabindex="-1"></a><span class="fu">tail</span>(casam)</span></code></pre></div>
<pre><code>##       cod_ibge   municipios reg_administrativa  ano
## 14763  3557303 Estiva Gerbi     RA de Campinas 2017
## 14764  3557303 Estiva Gerbi     RA de Campinas 2018
## 14765  3557303 Estiva Gerbi     RA de Campinas 2019
## 14766  3557303 Estiva Gerbi     RA de Campinas 2020
## 14767  3557303 Estiva Gerbi     RA de Campinas 2021
## 14768  3557303 Estiva Gerbi     RA de Campinas 2022
##       entre.pessoas.de.sexos.diferentes
## 14763                                86
## 14764                                65
## 14765                                86
## 14766                                56
## 14767                                74
## 14768                                69
##       entre.pessoas.do.mesmo.sexo ignorado total
## 14763                          NA       NA    86
## 14764                           1       NA    66
## 14765                          NA       NA    86
## 14766                           1       NA    57
## 14767                           1       NA    75
## 14768                          NA       NA    69</code></pre>
<p>Outra forma de entender melhor os dados é olhando a sua estrutura. Use <strong>str()</strong></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="tidyverse.html#cb161-1" tabindex="-1"></a><span class="co">#para ver a estrutura dos dados</span></span>
<span id="cb161-2"><a href="tidyverse.html#cb161-2" tabindex="-1"></a><span class="fu">str</span>(casam)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    14768 obs. of  8 variables:
##  $ cod_ibge                         : int  3500105 3500105 3500105 3500105 3500105 3500105 3500105 3500105 3500105 3500105 ...
##  $ municipios                       : chr  &quot;Adamantina&quot; &quot;Adamantina&quot; &quot;Adamantina&quot; &quot;Adamantina&quot; ...
##  $ reg_administrativa               : chr  &quot;RA de Presidente Prudente&quot; &quot;RA de Presidente Prudente&quot; &quot;RA de Presidente Prudente&quot; &quot;RA de Presidente Prudente&quot; ...
##  $ ano                              : int  2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 ...
##  $ entre.pessoas.de.sexos.diferentes: int  139 136 112 141 119 125 196 185 173 148 ...
##  $ entre.pessoas.do.mesmo.sexo      : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ ignorado                         : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ total                            : int  139 136 112 141 119 125 196 185 173 148 ...</code></pre>
</div>
<div id="filtrando-observações" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Filtrando observações<a href="tidyverse.html#filtrando-observações" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A função <strong>filter()</strong> filtra as observações (linhas) de acordo com uma condição.</p>
<p>A partir do dataframe ‘casam’, vamos filtrar os dados para mantermos apenas dados do ano de 2021, criando o objeto ‘casam_2021’.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="tidyverse.html#cb163-1" tabindex="-1"></a><span class="co">#para filtrar para o ano 2021</span></span>
<span id="cb163-2"><a href="tidyverse.html#cb163-2" tabindex="-1"></a>casam_2021 <span class="ot">&lt;-</span> casam <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="tidyverse.html#cb163-3" tabindex="-1"></a>  <span class="fu">filter</span>(ano <span class="sc">==</span> <span class="dv">2021</span>)</span></code></pre></div>
<p>Outras condições podem ser também filtradas. Vamos filtrar para o município “São Paulo”.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="tidyverse.html#cb164-1" tabindex="-1"></a>casam <span class="sc">%&gt;%</span></span>
<span id="cb164-2"><a href="tidyverse.html#cb164-2" tabindex="-1"></a>  <span class="fu">filter</span>(municipios <span class="sc">==</span> <span class="st">&quot;São Paulo&quot;</span>)</span></code></pre></div>
<pre><code>##    cod_ibge municipios reg_administrativa  ano
## 1   3550308  São Paulo   RM  de São Paulo 2000
## 2   3550308  São Paulo   RM  de São Paulo 2001
## 3   3550308  São Paulo   RM  de São Paulo 2002
## 4   3550308  São Paulo   RM  de São Paulo 2003
## 5   3550308  São Paulo   RM  de São Paulo 2004
## 6   3550308  São Paulo   RM  de São Paulo 2005
## 7   3550308  São Paulo   RM  de São Paulo 2006
## 8   3550308  São Paulo   RM  de São Paulo 2007
## 9   3550308  São Paulo   RM  de São Paulo 2008
## 10  3550308  São Paulo   RM  de São Paulo 2009
## 11  3550308  São Paulo   RM  de São Paulo 2010
## 12  3550308  São Paulo   RM  de São Paulo 2011
## 13  3550308  São Paulo   RM  de São Paulo 2012
## 14  3550308  São Paulo   RM  de São Paulo 2013
## 15  3550308  São Paulo   RM  de São Paulo 2014
## 16  3550308  São Paulo   RM  de São Paulo 2015
## 17  3550308  São Paulo   RM  de São Paulo 2016
## 18  3550308  São Paulo   RM  de São Paulo 2017
## 19  3550308  São Paulo   RM  de São Paulo 2018
## 20  3550308  São Paulo   RM  de São Paulo 2019
## 21  3550308  São Paulo   RM  de São Paulo 2020
## 22  3550308  São Paulo   RM  de São Paulo 2021
## 23  3550308  São Paulo   RM  de São Paulo 2022
##    entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                              47937                          NA
## 2                              50019                          NA
## 3                              50035                          NA
## 4                              51117                          NA
## 5                              55887                          NA
## 6                              57688                          NA
## 7                              60248                          NA
## 8                              62883                          NA
## 9                              65732                          NA
## 10                             62700                          NA
## 11                             62990                          NA
## 12                             65764                          NA
## 13                             66305                          NA
## 14                             67226                         820
## 15                             70960                         791
## 16                             73716                         770
## 17                             70500                         798
## 18                             70385                         926
## 19                             65732                        1767
## 20                             63658                        1385
## 21                             45375                         969
## 22                             52072                        1109
## 23                             56213                        1638
##    ignorado total
## 1        NA 47937
## 2        NA 50019
## 3        NA 50035
## 4        NA 51117
## 5        NA 55887
## 6        NA 57688
## 7        NA 60248
## 8        NA 62883
## 9        NA 65732
## 10       NA 62700
## 11       NA 62990
## 12       NA 65764
## 13       NA 66305
## 14      248 68294
## 15       NA 71751
## 16       NA 74486
## 17       NA 71298
## 18       NA 71311
## 19       NA 67499
## 20       NA 65043
## 21       NA 46344
## 22       NA 53181
## 23        1 57852</code></pre>
<p>As duas condições podem ser filtradas em um mesmo código.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="tidyverse.html#cb166-1" tabindex="-1"></a>casam <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="tidyverse.html#cb166-2" tabindex="-1"></a>  <span class="fu">filter</span>(ano <span class="sc">==</span> <span class="dv">2021</span>, municipios <span class="sc">==</span> <span class="st">&quot;São Paulo&quot;</span>)</span></code></pre></div>
<pre><code>##   cod_ibge municipios reg_administrativa  ano
## 1  3550308  São Paulo   RM  de São Paulo 2021
##   entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                             52072                        1109
##   ignorado total
## 1       NA 53181</code></pre>
<p>Também é possível filtrar a partir de operadores lógicos. Vamos filtrar os municípios com casamentos entre pessoas de sexos diferentes maior do que 5000 em 2021.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="tidyverse.html#cb168-1" tabindex="-1"></a><span class="co">#para filtrar para o ano de 2021 e municípios com casamentos entre pessoas de sexos diferentes maiores do que 5 mil</span></span>
<span id="cb168-2"><a href="tidyverse.html#cb168-2" tabindex="-1"></a>casam <span class="sc">%&gt;%</span> </span>
<span id="cb168-3"><a href="tidyverse.html#cb168-3" tabindex="-1"></a>  <span class="fu">filter</span>(ano <span class="sc">==</span> <span class="dv">2021</span>, entre.pessoas.de.sexos.diferentes <span class="sc">&gt;</span> <span class="dv">5000</span>)</span></code></pre></div>
<pre><code>##   cod_ibge municipios reg_administrativa  ano
## 1  3509502   Campinas     RA de Campinas 2021
## 2  3518800  Guarulhos   RM  de São Paulo 2021
## 3  3550308  São Paulo   RM  de São Paulo 2021
##   entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                              6017                         107
## 2                              7021                          79
## 3                             52072                        1109
##   ignorado total
## 1       NA  6124
## 2       NA  7100
## 3       NA 53181</code></pre>
</div>
<div id="organizando-uma-tabela-com-a-função-arrange" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Organizando uma tabela com a função <code>arrange()</code><a href="tidyverse.html#organizando-uma-tabela-com-a-função-arrange" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A função <strong>arrange()</strong> organiza uma tabela com base em uma variável (coluna). A condição <em>default</em> é a ordem crescente. Para indicar ordem decrescente, é necessário indicar <em>desc</em>. Vamos a um exemplo. Vamos solicitar a organização da tabela pela coluna entre.pessoas.de.mesmo.sexo.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="tidyverse.html#cb170-1" tabindex="-1"></a><span class="co">#para filtrar as linhas que correspondem ao ano 2021</span></span>
<span id="cb170-2"><a href="tidyverse.html#cb170-2" tabindex="-1"></a>msexo_2021 <span class="ot">&lt;-</span> casam <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="tidyverse.html#cb170-3" tabindex="-1"></a>  <span class="fu">filter</span>(ano <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="tidyverse.html#cb170-4" tabindex="-1"></a><span class="co">#para organizar em ordem crescente</span></span>
<span id="cb170-5"><a href="tidyverse.html#cb170-5" tabindex="-1"></a>  <span class="fu">arrange</span>(entre.pessoas.do.mesmo.sexo)</span>
<span id="cb170-6"><a href="tidyverse.html#cb170-6" tabindex="-1"></a><span class="co">#para visualizar</span></span>
<span id="cb170-7"><a href="tidyverse.html#cb170-7" tabindex="-1"></a><span class="fu">head</span>(msexo_2021)</span></code></pre></div>
<pre><code>##   cod_ibge             municipios          reg_administrativa
## 1  3500105             Adamantina   RA de Presidente Prudente
## 2  3500204                 Adolfo RA de São José do Rio Preto
## 3  3500550 Águas de Santa Bárbara              RA de Sorocaba
## 4  3500600     Águas de São Pedro              RA de Campinas
## 5  3500808      Alfredo Marcondes   RA de Presidente Prudente
## 6  3501707    Américo Brasiliense                  RA Central
##    ano entre.pessoas.de.sexos.diferentes
## 1 2021                               122
## 2 2021                                27
## 3 2021                                34
## 4 2021                                16
## 5 2021                                21
## 6 2021                               168
##   entre.pessoas.do.mesmo.sexo ignorado total
## 1                           1       NA   123
## 2                           1       NA    28
## 3                           1       NA    35
## 4                           1       NA    17
## 5                           1       NA    22
## 6                           1       NA   169</code></pre>
<p>Para organizar em ordem decrescente:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="tidyverse.html#cb172-1" tabindex="-1"></a><span class="co">#para filtrar as linhas que correspondem ao ano 2021</span></span>
<span id="cb172-2"><a href="tidyverse.html#cb172-2" tabindex="-1"></a>casam_msexo_desc <span class="ot">&lt;-</span> casam <span class="sc">%&gt;%</span></span>
<span id="cb172-3"><a href="tidyverse.html#cb172-3" tabindex="-1"></a>  <span class="fu">filter</span>(ano <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="tidyverse.html#cb172-4" tabindex="-1"></a><span class="co">#para organizar em ordem decrescente</span></span>
<span id="cb172-5"><a href="tidyverse.html#cb172-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(entre.pessoas.do.mesmo.sexo))</span>
<span id="cb172-6"><a href="tidyverse.html#cb172-6" tabindex="-1"></a><span class="co">#para visualizar</span></span>
<span id="cb172-7"><a href="tidyverse.html#cb172-7" tabindex="-1"></a><span class="fu">head</span>(casam_msexo_desc)</span></code></pre></div>
<pre><code>##   cod_ibge     municipios   reg_administrativa  ano
## 1  3550308      São Paulo     RM  de São Paulo 2021
## 2  3509502       Campinas       RA de Campinas 2021
## 3  3518800      Guarulhos     RM  de São Paulo 2021
## 4  3543402 Ribeirão Preto RA de Ribeirão Preto 2021
## 5  3552205       Sorocaba       RA de Sorocaba 2021
## 6  3534401         Osasco     RM  de São Paulo 2021
##   entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                             52072                        1109
## 2                              6017                         107
## 3                              7021                          79
## 4                              3636                          79
## 5                              4283                          76
## 6                              4224                          71
##   ignorado total
## 1       NA 53181
## 2       NA  6124
## 3       NA  7100
## 4       NA  3715
## 5       NA  4359
## 6       NA  4295</code></pre>
</div>
<div id="o-verbo-mutate" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> O verbo “mutate”<a href="tidyverse.html#o-verbo-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Digamos que quiséssemos ter uma coluna com a porcentagem de casamentos entre pessoas de sexos diferentes. Para isso seria necessário dividir a coluna <strong>entre.pessoas.de.sexos.diferentes</strong> pela coluna <strong>total</strong> e multiplicar por 100. A função <strong>mutate()</strong> permite mudar por meio de cálculos ou adicionar variáveis (colunas).</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="tidyverse.html#cb174-1" tabindex="-1"></a><span class="co">#para acrescentar uma coluna com os resultados da porcentagem de casamentos entre pessoas de sexos diferentes</span></span>
<span id="cb174-2"><a href="tidyverse.html#cb174-2" tabindex="-1"></a>casam1 <span class="ot">&lt;-</span> casam <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="tidyverse.html#cb174-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_sexodif =</span> entre.pessoas.de.sexos.diferentes <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-4"><a href="tidyverse.html#cb174-4" tabindex="-1"></a><span class="co">#para organizar a coluna em ordem decrescente</span></span>
<span id="cb174-5"><a href="tidyverse.html#cb174-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_sexodif))</span>
<span id="cb174-6"><a href="tidyverse.html#cb174-6" tabindex="-1"></a><span class="co">#para visualizar as 6 primeiras linhas</span></span>
<span id="cb174-7"><a href="tidyverse.html#cb174-7" tabindex="-1"></a><span class="fu">head</span>(casam1)</span></code></pre></div>
<pre><code>##   cod_ibge municipios        reg_administrativa  ano
## 1  3500105 Adamantina RA de Presidente Prudente 2000
## 2  3500105 Adamantina RA de Presidente Prudente 2001
## 3  3500105 Adamantina RA de Presidente Prudente 2002
## 4  3500105 Adamantina RA de Presidente Prudente 2003
## 5  3500105 Adamantina RA de Presidente Prudente 2004
## 6  3500105 Adamantina RA de Presidente Prudente 2005
##   entre.pessoas.de.sexos.diferentes entre.pessoas.do.mesmo.sexo
## 1                               139                          NA
## 2                               136                          NA
## 3                               112                          NA
## 4                               141                          NA
## 5                               119                          NA
## 6                               125                          NA
##   ignorado total perc_sexodif
## 1       NA   139          100
## 2       NA   136          100
## 3       NA   112          100
## 4       NA   141          100
## 5       NA   119          100
## 6       NA   125          100</code></pre>
<p>Observe que municípios com pequeno número total de casamentos, quando 1 deles é entre pessoas do mesmo sexo, o percentual fica elevado.</p>
</div>
<div id="agrupando-dados-com-a-função-group_by" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Agrupando dados com a função <code>group_by</code><a href="tidyverse.html#agrupando-dados-com-a-função-group_by" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A função <strong>group_by</strong> permite aplicar cálculos de resumo segundo grupos, por exemplo, por ano, por Região Administrativa, etc. Para usar essa função é necessário definir o tipo de agregação que queremos. Em outras palavras, se vamos agrupar os casamentos por Região Administrativa, os resultados serão as somas dos casamentos das regiões? Ou seriam as médias? Dependendo da variável, não faz sentido efetuarmos a soma como no caso de variáveis resultantes de divisões (índices, porcentagens, razões, etc.) deve-se calcular a média, por meio da função <code>summarize</code> (mean). No nosso exemplo, vamos agrupar as regiões administrativas por meio de soma para as variáveis entre.pessoas.de.sexos.diferentes, entre.pessoas.do.mesmo.sexo e total.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="tidyverse.html#cb176-1" tabindex="-1"></a><span class="co">#para agrupar por região administrativa</span></span>
<span id="cb176-2"><a href="tidyverse.html#cb176-2" tabindex="-1"></a>casam <span class="sc">%&gt;%</span> </span>
<span id="cb176-3"><a href="tidyverse.html#cb176-3" tabindex="-1"></a>  <span class="fu">group_by</span>(reg_administrativa) <span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="tidyverse.html#cb176-4" tabindex="-1"></a><span class="co">#para definir a soma como operação de agrupamento. &#39;na.omit&#39; é usado para que a soma desconsidere os valores NA da coluna entre.pessoas.do.mesmo.sexo</span></span>
<span id="cb176-5"><a href="tidyverse.html#cb176-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tot_sexodif =</span> <span class="fu">sum</span>(entre.pessoas.de.sexos.diferentes),</span>
<span id="cb176-6"><a href="tidyverse.html#cb176-6" tabindex="-1"></a>            <span class="at">tot_msexo =</span> <span class="fu">sum</span>(<span class="fu">na.omit</span>(entre.pessoas.do.mesmo.sexo)),</span>
<span id="cb176-7"><a href="tidyverse.html#cb176-7" tabindex="-1"></a>            <span class="at">tot_todos =</span> <span class="fu">sum</span>(total))</span></code></pre></div>
<pre><code>## # A tibble: 16 × 4
##    reg_administrativa          tot_sexodif tot_msexo tot_todos
##    &lt;chr&gt;                             &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
##  1 RA Central                       132776       619    133420
##  2 RA de Araçatuba                  100275       307    100602
##  3 RA de Barretos                    57897       211     58119
##  4 RA de Bauru                      148751       552    149316
##  5 RA de Campinas                   893340      3840    897859
##  6 RA de Franca                      92649       301     92974
##  7 RA de Itapeva                     72322       131     72475
##  8 RA de Marília                    129304       373    129700
##  9 RA de Presidente Prudente        116224       327    116563
## 10 RA de Registro                    36611        67     36692
## 11 RA de Ribeirão Preto             162735       813    163579
## 12 RA de Santos                     211221      1482    212739
## 13 RA de Sorocaba                   346753      1590    348424
## 14 RA de São José do Rio Preto      194609       871    195513
## 15 RA de São José dos Campos        334861      1499    336420
## 16 RM  de São Paulo                2616946     16027   2633463</code></pre>
<p>Observe que passamos a ter 16 linhas, correspondendo às 16 Regiões Administrativas do Estado.
Vamos resumir por ano e região administrativa.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="tidyverse.html#cb178-1" tabindex="-1"></a><span class="co">#para agrupar por região administrativa</span></span>
<span id="cb178-2"><a href="tidyverse.html#cb178-2" tabindex="-1"></a>casam_regadm <span class="ot">&lt;-</span> casam <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="tidyverse.html#cb178-3" tabindex="-1"></a>  <span class="fu">group_by</span>(ano, reg_administrativa) <span class="sc">%&gt;%</span></span>
<span id="cb178-4"><a href="tidyverse.html#cb178-4" tabindex="-1"></a><span class="co">#para definir a soma como operação de agrupamento. &#39;na.omit&#39; é usado para que a soma desconsidere os valores NA da coluna entre.pessoas.do.mesmo.sexo</span></span>
<span id="cb178-5"><a href="tidyverse.html#cb178-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tot_sexodif =</span> <span class="fu">sum</span>(entre.pessoas.de.sexos.diferentes),</span>
<span id="cb178-6"><a href="tidyverse.html#cb178-6" tabindex="-1"></a>            <span class="at">tot_msexo =</span> <span class="fu">sum</span>(<span class="fu">na.omit</span>(entre.pessoas.do.mesmo.sexo)),</span>
<span id="cb178-7"><a href="tidyverse.html#cb178-7" tabindex="-1"></a>            <span class="at">tot_todos =</span> <span class="fu">sum</span>(total))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;ano&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="tidyverse.html#cb180-1" tabindex="-1"></a><span class="co">#para visualizar</span></span>
<span id="cb180-2"><a href="tidyverse.html#cb180-2" tabindex="-1"></a><span class="fu">head</span>(casam_regadm)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
## # Groups:   ano [1]
##     ano reg_administrativa tot_sexodif tot_msexo tot_todos
##   &lt;int&gt; &lt;chr&gt;                    &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
## 1  2000 RA Central                4164         0      4164
## 2  2000 RA de Araçatuba           3438         0      3438
## 3  2000 RA de Barretos            1662         0      1662
## 4  2000 RA de Bauru               5116         0      5116
## 5  2000 RA de Campinas           28634         0     28634
## 6  2000 RA de Franca              3291         0      3291</code></pre>
<p>Agora temos 352 linhas, resultantes de 16 regiões administrativas vezes 22 anos.</p>
</div>
<div id="rumo-aos-mapas" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Rumo aos mapas<a href="tidyverse.html#rumo-aos-mapas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agora que você teve uma introdução rápida ao <strong>R</strong> e aprendeu a fazer cálculos entre colunas, unir dataframes e agrupar dados, tem a bagagem mínima para entrar em contato com a teoria da Cartografia Temática e a elaborar seus mapas em <strong>R</strong>.
Novas funções serão apresentadas à medida que forem necessárias.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataframes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tipos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ligiaviz/RCartoTematica/edit/main/04-dataframes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ligiaviz/RCartoTematica/blob/main/04-dataframes.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
